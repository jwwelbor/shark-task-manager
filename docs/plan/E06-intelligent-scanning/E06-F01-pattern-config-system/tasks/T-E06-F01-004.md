---
task_key: T-E06-F01-004
status: todo
feature: /docs/plan/E06-intelligent-scanning/E06-F01-pattern-config-system
created: 2025-12-17
assigned_agent: backend
dependencies: []
estimated_time: 8 hours
---

# Task: Implement Pattern Testing CLI Commands

---

## Goal

Implement CLI commands for testing regex patterns against sample strings and validating all patterns in configuration, enabling users to debug patterns before scanning thousands of files.

## What to Build

Create interactive pattern testing and validation commands that provide immediate feedback on pattern correctness and matching behavior.

**Core Components**:

1. **Test Pattern Command** (`shark config test-pattern`):
   - Options: `--pattern=<regex>`, `--test-string=<string>`, `--type=<epic|feature|task>`
   - Compile pattern and attempt match against test string
   - On successful match: display captured groups and values
   - On failed match: indicate no match and suggest similar patterns from config
   - Validate capture groups for specified type (warn if required groups missing)
   - Complete in <500ms for immediate feedback
   - Example output:
     ```
     Pattern Test Result:
       Pattern: ^(?P<number>\d{2})-.*\.md$
       Test File: 01-research.md
       Match: true
       Captured Groups:
         - number: 01

     Validation: PASSED
       Required capture groups present: number
     ```

2. **Validate Patterns Command** (`shark config validate-patterns`):
   - Validate all patterns in current `.sharkconfig.json`
   - Report validation results grouped by entity type (epic, feature, task)
   - Distinguish between errors (must fix) and warnings (should review)
   - Exit with non-zero status if any errors found (for CI integration)
   - Example output:
     ```
     Pattern Validation Report:
       Epic patterns: 2 valid, 0 errors, 0 warnings
       Feature patterns: 3 valid, 0 errors, 1 warning
       Task patterns: 3 valid, 1 error, 0 warnings

     Errors:
       [ERROR] Task pattern #2: Missing required capture group 'number'

     Warnings:
       [WARN] Feature pattern #3: Capture group 'feature_number' not recognized
     ```

3. **Show Configuration Command** (`shark config show`):
   - Display all config settings (default mode)
   - With `--patterns` flag: display only pattern-related configuration
   - Format output for readability (pretty-printed JSON or table format)
   - Indicate which patterns are defaults vs. user-customized

4. **Query Generation Format** (`shark config get-format --type=<epic|feature|task>`):
   - Return generation format template for specified type
   - Support `--json` flag for programmatic access (AI agents)
   - Include example with sample values
   - Example output: `E{number:02d}-{slug}` or JSON: `{"format": "E{number:02d}-{slug}", "example": "E04-example-epic"}`

## Why This Matters

Pattern testing eliminates trial-and-error debugging during scans. Users can validate patterns work correctly before scanning hundreds of files, catching errors in seconds instead of minutes. The <500ms response time provides immediate feedback for rapid iteration.

## Success Criteria

- [ ] `shark config test-pattern` matches pattern against test string
- [ ] Successful match displays captured groups and values
- [ ] Failed match suggests similar patterns from config
- [ ] Validation warnings shown for missing required capture groups
- [ ] `shark config validate-patterns` checks all patterns in config
- [ ] Validation results grouped by entity type with error/warning distinction
- [ ] Exit code 0 for success, non-zero for validation failures (CI compatible)
- [ ] `shark config show` displays all settings or patterns only with flag
- [ ] `shark config get-format` returns generation format with example
- [ ] Pattern testing completes in <500ms

## Reference Documents

- **PRD**: `/docs/plan/E06-intelligent-scanning/E06-F01-pattern-config-system/prd.md`
  - Requirements: FR-013 (Test Pattern Command), FR-014 (Validate Patterns Command), FR-015 (Show Configuration), FR-016 (Query Generation Format)
  - NFR-001 (Pattern Validation Speed)
  - Acceptance Criteria: AC-013, AC-014, AC-015, AC-016, AC-017, AC-018, AC-019, AC-020

## Dependencies

- T-E06-F01-001 (Pattern Configuration Schema)
- T-E06-F01-002 (Pattern Validation Engine)

## Validation

1. Test pattern match success with captured groups displayed
2. Test pattern match failure with no match indication
3. Test pattern validation failure with clear error
4. Test `shark config validate-patterns` with mixed valid/invalid patterns
5. Test `shark config show` displays all config
6. Test `shark config show --patterns` displays only patterns
7. Test `shark config get-format --type=task` returns format template
8. Test `shark config get-format --type=task --json` returns JSON
9. Verify test-pattern completes in <500ms

## Estimated Complexity

**Medium** - CLI command implementation with pattern matching, validation, and output formatting

---

**Status**: created
**Created**: 2025-12-17

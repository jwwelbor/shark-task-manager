---
agent: general
created_at: 2025-12-21T19:53:12Z
epic: E07
feature: E07-F06
key: T-E07-F06-001
priority: 5
status: todo
task_key: T-E07-F06-009
title: Pattern Matching Helpers
---


# Task: Pattern Matching Helpers

## Goal

Implement core pattern matching helper functions for parsing and validating epic and feature key formats in CLI positional arguments.

## Requirements

### Functional Requirements

- [ ] Implement `IsEpicKey(s string) bool` - validates E## format
- [ ] Implement `IsFeatureKey(s string) bool` - validates E##-F## format
- [ ] Implement `IsFeatureKeySuffix(s string) bool` - validates F## format
- [ ] Implement `ParseFeatureKey(s string) (epic, feature string, err error)` - parses combined format
- [ ] All functions handle case-sensitivity (uppercase only)
- [ ] Rejection of invalid formats (E1, E001, e04, etc.)

### Non-Functional Requirements

- [ ] Pattern matching must complete in < 1ms per call
- [ ] No external dependencies (stdlib regex only)
- [ ] 100% test coverage for pattern matching functions

## Implementation Plan

### Steps

1. [ ] Create `internal/cli/commands/helpers.go` file
2. [ ] Implement pattern validation functions using regex:
   - Epic pattern: `^E\d{2}$`
   - Feature pattern: `^E\d{2}-F\d{2}$`
   - Feature suffix: `^F\d{2}$`
3. [ ] Add ParseFeatureKey() function to parse "E##-F##" format
4. [ ] Add comprehensive error messages for validation failures
5. [ ] Write 15+ unit tests covering all valid/invalid patterns
6. [ ] Verify performance (no compilation of regex each call)

### Technical Approach

- Use `regexp.MustCompile()` at package init to compile patterns once
- Keep functions pure (no side effects)
- Return clear error messages for invalid inputs
- Place in `internal/cli/commands/helpers.go` for command-layer reuse

## Deliverables

- [ ] `internal/cli/commands/helpers.go` with 4 pattern functions
- [ ] `internal/cli/commands/helpers_test.go` with unit tests
- [ ] 15+ test cases covering valid/invalid epic, feature, and suffix formats

## Acceptance Criteria

- [ ] All 4 functions implemented and tested
- [ ] Unit tests pass with 100% coverage
- [ ] Valid patterns: E01, E99, E04-F01, F01 all pass
- [ ] Invalid patterns: E1, e04, E001, E04F01, F1 all fail with clear errors
- [ ] No regex recompilation on each call (performance gate)
- [ ] Code follows project standards in CLAUDE.md

## Testing Strategy

**Unit Tests** (in `_test.go`):
- 5 test cases for IsEpicKey: valid (E01, E99), invalid (E1, e04, E001)
- 5 test cases for IsFeatureKey: valid (E04-F01), invalid (E04F01, E4-F01)
- 3 test cases for IsFeatureKeySuffix: valid (F01), invalid (F1, f01)
- 2 test cases for ParseFeatureKey: success and error cases

**Verification**:
```bash
go test -v ./internal/cli/commands -run TestPattern
go test -cover ./internal/cli/commands
```

## Related Documents

- See `feature-spec.md` for design details
- See `../feature-spec.md` section "Pattern Matching Functions" for API contract

## Dependencies

- None (stdlib only)
- Must complete before T-E07-F06-002 and T-E07-F06-003

## Notes

- Keep functions simple and focused
- Regex patterns must be identical to those in feature spec
- Error messages must match spec examples exactly
- Pattern functions are building blocks for argument parsing tasks

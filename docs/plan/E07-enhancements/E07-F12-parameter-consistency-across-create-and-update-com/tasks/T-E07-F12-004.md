---
agent: backend
created_at: 2026-01-01T07:35:51Z
epic: E07
feature: E07-F12
key: T-E07-F12-004
priority: 8
status: todo
task_key: T-E07-F12-013
title: Create status_priority.go with parsing functions
---


# Task: Create status_priority.go with parsing functions

## Goal

Create a shared status/priority parsing module that handles extraction and validation of status/priority flags with defaults. This eliminates duplicate parsing code across epic and feature commands.

## Related Documentation

- Implementation Plan: dev-artifacts/2026-01-01-parameter-consistency-research/implementation-plan.md (lines 274-337)

## Implementation Details

### File to Create

- Location: internal/cli/commands/status_priority.go

### API Design

Create the following functions:

```go
// ParseEpicStatus extracts and validates --status flag for epic create
// Returns default if flag not provided
func ParseEpicStatus(cmd *cobra.Command, defaultStatus models.EpicStatus) (models.EpicStatus, error)

// ParseEpicPriority extracts and validates --priority flag for epic create
// Returns default if flag not provided
func ParseEpicPriority(cmd *cobra.Command, defaultPriority models.Priority) (models.Priority, error)

// ParseEpicBusinessValue extracts and validates --business-value flag
// Returns nil if flag not provided (nullable field)
func ParseEpicBusinessValue(cmd *cobra.Command) (*models.Priority, error)

// ParseFeatureStatus extracts and validates --status flag for feature create
// Returns default if flag not provided
func ParseFeatureStatus(cmd *cobra.Command, defaultStatus models.FeatureStatus) (models.FeatureStatus, error)
```

### Implementation Pattern

Each parser follows this pattern:
1. Extract flag value from cobra.Command
2. If empty/not provided, return default value
3. Validate value using validators.go functions
4. Return parsed and validated value

Example:
```go
func ParseEpicStatus(cmd *cobra.Command, defaultStatus models.EpicStatus) (models.EpicStatus, error) {
    statusStr, _ := cmd.Flags().GetString("status")
    if statusStr == "" {
        return defaultStatus, nil
    }

    status := models.EpicStatus(statusStr)
    if err := ValidateStatus(string(status), "epic"); err != nil {
        return "", err
    }

    return status, nil
}
```

### Implementation Strategy

1. Extract parsing logic from epic.go and feature.go
2. Identify common patterns for status/priority handling
3. Create reusable functions that use validators.go
4. Write comprehensive tests
5. DO NOT modify epic.go or feature.go yet (that's Phase 3)

### Dependencies

- Uses ValidateStatus and ValidatePriority from validators.go (T-E07-F12-002)
- Must coordinate with validators.go implementation

## Acceptance Criteria

- [ ] ParseEpicStatus returns default when flag not provided
- [ ] ParseEpicStatus validates using ValidateStatus
- [ ] ParseEpicPriority returns default when flag not provided
- [ ] ParseEpicPriority validates using ValidatePriority
- [ ] ParseEpicBusinessValue returns nil when flag not provided
- [ ] ParseEpicBusinessValue validates using ValidatePriority
- [ ] ParseFeatureStatus returns default when flag not provided
- [ ] ParseFeatureStatus validates using ValidateStatus
- [ ] All functions use cobra.Command flag extraction
- [ ] Error messages provide clear context
- [ ] No changes to epic.go or feature.go

## Testing Requirements

### Unit Tests (status_priority_test.go)

- [ ] TestParseEpicStatus_NotProvided - Returns default
- [ ] TestParseEpicStatus_Valid - All valid status values
- [ ] TestParseEpicStatus_Invalid - Invalid status value
- [ ] TestParseEpicPriority_NotProvided - Returns default
- [ ] TestParseEpicPriority_Valid - All valid priority values
- [ ] TestParseEpicPriority_Invalid - Invalid priority value
- [ ] TestParseEpicBusinessValue_NotProvided - Returns nil
- [ ] TestParseEpicBusinessValue_Valid - All valid values
- [ ] TestParseEpicBusinessValue_Invalid - Invalid value
- [ ] TestParseFeatureStatus_NotProvided - Returns default
- [ ] TestParseFeatureStatus_Valid - All valid status values
- [ ] TestParseFeatureStatus_Invalid - Invalid status value

### Test Pattern

Each test should:
1. Create a test cobra.Command
2. Set (or don't set) the flag value
3. Call the parser function
4. Verify expected result or error

### Coverage Target

- 95%+ coverage for status_priority.go

## Notes

- This is Phase 2 Task 4 of 5
- Extracts status/priority parsing into reusable functions
- Must be completed before Phase 3 refactoring
- Follow TDD: write tests first, then implementation
- All tests should be pure unit tests (no database, no mocks needed)
- Coordinates with validators.go for validation logic

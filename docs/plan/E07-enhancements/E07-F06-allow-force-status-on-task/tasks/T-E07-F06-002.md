---
agent: general
created_at: 2025-12-21T19:53:20Z
epic: E07
feature: E07-F06
key: T-E07-F06-002
priority: 5
status: todo
task_key: T-E07-F06-010
title: Feature List Positional Arguments
---


# Task: Feature List Positional Arguments

## Goal

Implement positional argument parsing for the `shark feature list` command to accept 0-1 epic key argument, while maintaining full backward compatibility with flag-based `--epic=E##` syntax.

## Requirements

### Functional Requirements

- [ ] Feature list accepts 0-1 positional argument
- [ ] No args: list all features (no filter)
- [ ] 1 arg matching E##: filter features to that epic
- [ ] 2+ args: display clear error
- [ ] Validate epic key format using pattern helpers
- [ ] Maintain `--epic=` flag behavior unchanged
- [ ] Positional arg takes priority if both flag and positional provided

### Non-Functional Requirements

- [ ] Zero performance impact on feature list command
- [ ] 100% backward compatibility
- [ ] Argument parsing < 1ms
- [ ] Help text updated with positional examples

## Implementation Plan

### Steps

1. [ ] Review current `feature.go` list command implementation
2. [ ] Extract positional arguments from Cobra cmd.Args() or use cmd.Flags().Args()
3. [ ] Implement ParseFeatureListArgs() using IsEpicKey() helper
4. [ ] Update feature list command handler to:
   - Check for positional args first
   - Fall back to --epic flag if no positional
   - Apply appropriate filter based on parsed value
5. [ ] Update help text for `feature list` command
6. [ ] Add test coverage for positional parsing
7. [ ] Verify flag-based commands still work identically

### Technical Approach

- Modify `internal/cli/commands/feature.go` list command
- Use pattern helpers from T-E07-F06-001
- Handle Cobra argument parsing (cmd.Args())
- Keep error messages consistent with spec
- No database changes needed

## Deliverables

- [ ] Updated `feature list` command with positional argument support
- [ ] Updated help text with positional examples
- [ ] Updated integration tests in `feature_test.go`
- [ ] Verified backward compatibility

## Acceptance Criteria

- [ ] `shark feature list` - lists all features
- [ ] `shark feature list E04` - filters to epic E04 only
- [ ] `shark feature list --epic=E04` - identical results
- [ ] `shark feature list E04 F01` - error (too many args)
- [ ] `shark feature list xyz` - error (invalid format)
- [ ] Help shows "feature list [EPIC]"  with examples
- [ ] All existing tests pass
- [ ] No flag-based commands broken

## Testing Strategy

**Integration Tests**:
- Test 0 args: all features returned
- Test 1 arg valid epic: correct filtering
- Test 1 arg invalid format: error with guidance
- Test 2+ args: clear error message
- Test flag vs positional: positional takes priority
- Test nonexistent epic: existing error handling

**Regression Tests**:
- All existing feature list tests must pass
- Flag-based filtering unchanged
- JSON output format unchanged

## Related Documents

- See `feature-spec.md` section "FR1: Feature List Positional Arguments"
- See `feature-spec.md` section "ParseFeatureListArgs"

## Dependencies

- T-E07-F06-001: Pattern matching helpers (required)
- Requires review of current `internal/cli/commands/feature.go`

## Notes

- Feature list currently uses --epic flag; verify current behavior first
- Ensure Cobra allows positional argument extraction
- Help text must match spec examples exactly

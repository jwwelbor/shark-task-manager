---
agent: backend
created_at: 2026-01-01T19:35:37Z
depends_on:
    - T-E07-F14-004
epic: E07
feature: E07-F14
key: T-E07-F14-009
priority: 6
related-docs:
    - docs/plan/E07-enhancements/E07-F14-cascading-status-calculation/prd.md
status: todo
task_key: T-E07-F14-021
title: Update CLI output to show status source (calculated vs manual)
---

# Task: Update CLI output to show status source (calculated vs manual)

## Goal

Update feature and epic CLI output to clearly indicate whether status is automatically calculated from children or manually overridden.

## Requirements

### Functional Requirements

- [ ] `shark feature get` shows "(calculated)" or "(manual override)" after status
- [ ] `shark feature list` shows status source indicator
- [ ] `shark epic get` shows status source
- [ ] JSON output includes `status_source` field with value "calculated" or "manual"

### Non-Functional Requirements

- [ ] Minimal visual clutter in table output
- [ ] Consistent indicator format across commands
- [ ] No breaking changes to existing output parsing

## Implementation Plan

### Steps

1. [ ] Add StatusSource field to Feature output struct
2. [ ] Update feature get command to include source
3. [ ] Update feature list command to include source
4. [ ] Update epic get/list commands similarly
5. [ ] Add CLI tests for output format

### Technical Approach

Location: `internal/cli/commands/feature.go`

For JSON output:

```go
type FeatureOutput struct {
    // ... existing fields ...
    StatusSource string `json:"status_source"` // "calculated" or "manual"
}

func getStatusSource(feature *models.Feature) string {
    if feature.StatusOverride {
        return "manual"
    }
    return "calculated"
}
```

For table output:

```go
// In feature get command
statusDisplay := string(feature.Status)
if feature.StatusOverride {
    statusDisplay += " (manual override)"
} else {
    statusDisplay += " (calculated)"
}
```

For list command (abbreviated):

```go
// Use single character indicator to save space
statusDisplay := string(feature.Status)
if feature.StatusOverride {
    statusDisplay += "*"  // Asterisk indicates manual
}
```

## Deliverables

- [ ] Updated feature get/list output
- [ ] Updated epic get/list output
- [ ] CLI tests for output format

## Acceptance Criteria

- [ ] Feature get shows "(calculated)" for auto status
- [ ] Feature get shows "(manual override)" for overridden status
- [ ] Feature list uses compact indicator (asterisk or similar)
- [ ] JSON output includes `status_source` field
- [ ] Epic commands show same indicators

## Testing Strategy

```go
func TestFeatureGet_ShowsStatusSource(t *testing.T) {
    t.Run("shows_calculated_for_auto", func(t *testing.T) {
        // Create feature with no override
        // Run feature get
        // Verify output contains "(calculated)"
    })

    t.Run("shows_manual_for_override", func(t *testing.T) {
        // Create feature with override
        // Run feature get
        // Verify output contains "(manual override)"
    })
}

func TestFeatureList_JSONIncludesStatusSource(t *testing.T) {
    // Run feature list --json
    // Parse JSON output
    // Verify status_source field exists
}
```

## Dependencies

- T-E07-F14-004: StatusOverride field in Feature model

## Notes

- See PRD Story 5 for acceptance criteria
- Consider color coding (green for calculated, yellow for manual)
- Keep list output compact - full text only in get command

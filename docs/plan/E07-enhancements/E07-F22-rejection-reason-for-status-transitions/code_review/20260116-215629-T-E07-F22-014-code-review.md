# Code Review: T-E07-F22-014 - Update CLI reference documentation for rejection reasons

**Review Date:** 2026-01-17 02:40 UTC  
**Reviewer:** tech-lead  
**Status:** ❌ REJECTED - Critical Issue Found

---

## Critical Issue: Incorrect Flag Name Used Throughout Documentation

### Problem

The CLI reference documentation (docs/CLI_REFERENCE.md) uses `--reason` flag throughout the "Rejection Reasons for Status Transitions" section, but the **actual CLI implementation uses `--rejection-reason`**.

### Evidence

**Actual CLI Help Output:**
```bash
$ ./bin/shark task reopen --help
Flags:
      --reason-doc string         Path to document containing rejection reason (relative to project root)
      --rejection-reason string   Reason for rejection or sending task back
```

**Documentation (INCORRECT):**
```bash
shark task reopen <task-key> [--reason="..."] [--reason-doc="..."] [--notes="..."] [--force] [--json]
```

**Should be:**
```bash
shark task reopen <task-key> [--rejection-reason="..."] [--reason-doc="..."] [--notes="..."] [--force] [--json]
```

### Impact

- **100% command failure rate** for users following the documentation
- All code examples in the documentation will fail when executed
- Developers will receive "unknown flag" errors
- This creates confusion and erodes trust in documentation accuracy

### Root Cause

The original code review (docs/plan/.../code_review/20260116-code-review-T-E07-F22-014.md) correctly identified this issue and requested using `--rejection-reason`. However, the fix was applied in reverse - the documentation was changed to use `--reason` instead of correcting it to use `--rejection-reason`.

---

## Required Changes

### 1. Replace ALL instances of `--reason` with `--rejection-reason`

**Search and replace needed:**
- Find: `--reason=`
- Replace: `--rejection-reason=`
- Find: `--reason ` (with space)
- Replace: `--rejection-reason `

**Affected sections:**
- Line 684: Usage syntax
- Line 688: Flag documentation
- Line 701-719: All code examples
- Line 803: Section heading "#### --reason (Required for backward transitions)"
- Line 809: Format example
- Line 823-829: Best practice examples
- Line 957-977: Command examples (Reviewer/QA sections)
- Line 1007-1011: Error message examples

### 2. Update flag description heading

**Line 803:**
```diff
-#### --reason (Required for backward transitions)
+#### --rejection-reason (Required for backward transitions)
```

### 3. Update all example commands

**Example (one of many):**
```diff
-shark task reopen E07-F01-001 --reason="Missing error handling for database.Query() on line 67"
+shark task reopen E07-F01-001 --rejection-reason="Missing error handling for database.Query() on line 67"
```

---

## Verification Steps

After fixing, verify:

1. **Documentation accuracy:**
   ```bash
   grep -n "\\-\\-reason=" docs/CLI_REFERENCE.md
   # Should only show --rejection-reason= (NOT --reason=)
   ```

2. **All examples work:**
   ```bash
   # Test each example command from documentation
   ./bin/shark task reopen <key> --rejection-reason="test"
   ```

3. **Consistent with CLI help:**
   ```bash
   ./bin/shark task reopen --help | grep "rejection-reason"
   # Verify flag name matches documentation
   ```

---

## Original Code Review Was Correct

The initial code review at `docs/plan/.../code_review/20260116-code-review-T-E07-F22-014.md` correctly identified:

> The documentation uses `--reason` flag, but actual implementation uses `--rejection-reason`

The reviewer correctly requested:
> Replace all instances of `--reason` with `--rejection-reason` throughout the document.

However, this feedback was not properly applied. The task must be corrected to match the actual CLI implementation.

---

## Recommendation

**REJECT** and return to `in_development` for immediate correction.

This is a critical documentation bug that will cause 100% command failure for users. The fix is straightforward: global search-and-replace of `--reason` with `--rejection-reason` in the documented examples and flag references.

**Estimated fix time:** 10 minutes (global search and replace + verification)

---

## Decision

**Status:** ❌ REJECTED  
**Next Step:** Return to `in_development`  
**Priority:** HIGH - Critical user-facing documentation bug

---
agent: backend
created_at: 2026-01-01T06:56:41Z
epic: E07
feature: E07-F13
key: T-E07-F13-002
priority: 7
status: in_refinement
task_key: T-E07-F13-002
title: Deprecate AgentType enum constants
---

# Task: Deprecate AgentType enum constants

## Goal

Mark the `AgentType` enum type and its constants (`AgentTypeFrontend`, `AgentTypeBackend`, etc.) as deprecated to signal that the system now accepts any agent type string. This maintains 100% backward compatibility while guiding developers toward the new flexible agent type model.

**Key Principle**: Deprecate but DO NOT remove. The constants remain functional for existing code but are discouraged for new development.

## Deprecation Strategy

### What to Deprecate

**File**: `internal/models/task.go` (lines 35-45)

1. **AgentType type** (line 36):
   ```go
   // AgentType represents the type of agent assigned to a task
   type AgentType string
   ```

2. **All AgentType constants** (lines 38-45):
   - `AgentTypeFrontend`
   - `AgentTypeBackend`
   - `AgentTypeAPI`
   - `AgentTypeTesting`
   - `AgentTypeDevOps`
   - `AgentTypeGeneral`

### Deprecation Comments Template

Use Go's standard `Deprecated:` comment format:

```go
// AgentType represents the type of agent assigned to a task.
//
// Deprecated: As of E07-F13, agent types are no longer restricted to predefined constants.
// Use string literals directly (e.g., "architect", "business-analyst", "qa") or any custom
// agent type that matches your workflow. The ValidateAgentType() function now accepts any
// non-empty string. These constants are kept for backward compatibility but new code should
// use string literals directly.
type AgentType string

const (
	// AgentTypeFrontend represents the frontend agent type.
	// Deprecated: Use string literal "frontend" directly. See AgentType deprecation notice.
	AgentTypeFrontend AgentType = "frontend"

	// AgentTypeBackend represents the backend agent type.
	// Deprecated: Use string literal "backend" directly. See AgentType deprecation notice.
	AgentTypeBackend AgentType = "backend"

	// AgentTypeAPI represents the API agent type.
	// Deprecated: Use string literal "api" directly. See AgentType deprecation notice.
	AgentTypeAPI AgentType = "api"

	// AgentTypeTesting represents the testing agent type.
	// Deprecated: Use string literal "testing" directly. See AgentType deprecation notice.
	AgentTypeTesting AgentType = "testing"

	// AgentTypeDevOps represents the DevOps agent type.
	// Deprecated: Use string literal "devops" directly. See AgentType deprecation notice.
	AgentTypeDevOps AgentType = "devops"

	// AgentTypeGeneral represents the general-purpose agent type.
	// Deprecated: Use string literal "general" directly. See AgentType deprecation notice.
	AgentTypeGeneral AgentType = "general"
)
```

### Migration Guide for Developers

**Old Pattern (Deprecated)**:
```go
task := &models.Task{
    AgentType: &models.AgentTypeFrontend,
}
```

**New Pattern (Recommended)**:
```go
agentType := "frontend" // or "architect", "business-analyst", etc.
task := &models.Task{
    AgentType: &agentType,
}
```

**For Custom Agent Types**:
```go
agentType := "business-analyst"
task := &models.Task{
    AgentType: &agentType,
}
```

## Backward Compatibility Plan

### What MUST NOT Change

1. **Type remains usable**: `AgentType` type declaration stays in codebase
2. **Constants remain accessible**: All 6 constants (`AgentTypeFrontend`, etc.) remain defined
3. **Existing code continues working**: No changes required to existing code using constants
4. **No database migration**: Database already stores agent_type as TEXT with no constraints
5. **Field type unchanged**: `Task.AgentType` field remains `*AgentType` (pointer to AgentType)

### Breaking Change Analysis

**ZERO breaking changes**:
- ✅ Existing tasks using constants work unchanged
- ✅ Existing tests pass without modification
- ✅ All repository methods work with deprecated constants
- ✅ CLI commands accept both old constants and new string literals
- ✅ Database schema unchanged (already TEXT)

### Deprecation Timeline

**Phase 1: Soft Deprecation (This Task)**
- Add deprecation comments to type and constants
- Constants remain fully functional
- No warnings emitted at runtime
- Documentation updated to recommend string literals

**Phase 2: Active Use (Ongoing)**
- New code uses string literals directly
- Old code continues using constants (no rush to migrate)
- Both approaches coexist harmoniously

**Phase 3: Potential Removal (Far Future, Optional)**
- After 12+ months, consider removing constants (breaking change)
- Requires major version bump and migration guide
- NOT part of this feature - keep for indefinite backward compatibility

**Recommendation**: Keep constants indefinitely. Removing them provides minimal benefit and creates migration burden.

## Implementation Details

### Files to Modify

**File**: `internal/models/task.go`

**Lines to Update**: 35-45

**Changes Required**:
1. Add multi-line deprecation comment to `AgentType` type (line 35-36)
2. Add deprecation comment to each constant (lines 39-44)
3. Keep all existing code functional (no deletions)

### Validation Changes (Not This Task)

**Note**: This task only deprecates constants. Validation changes are handled in separate tasks:
- T-E07-F13-001: Update ValidateAgentType function
- T-E07-F13-003: Update template renderer validation
- T-E07-F13-004: Update task creation validator

### Testing Strategy

**No new tests required for deprecation comments** (comments don't affect runtime behavior).

**Verify**:
- [ ] Existing tests pass without modification
- [ ] Constants remain accessible in code
- [ ] Go doc shows deprecation notices
- [ ] IDE/editor shows deprecation warnings when using constants

## Acceptance Criteria

- [ ] Deprecation comment added to `AgentType` type definition
- [ ] Deprecation comment added to all 6 constants
- [ ] Comments follow Go's `Deprecated:` convention
- [ ] Comments explain migration path (use string literals)
- [ ] Comments reference E07-F13 for context
- [ ] No functional code changes (constants remain usable)
- [ ] All existing tests pass
- [ ] `go doc internal/models.AgentType` shows deprecation notice

## Documentation Requirements

### Code Documentation

- [ ] Deprecation comments use standard Go format
- [ ] Comments explain WHY (validation now accepts any string)
- [ ] Comments show HOW to migrate (use string literals)
- [ ] Comments reference feature (E07-F13) for context

### Developer Communication

**Note**: Documentation updates handled in separate task (T-E07-F13-005).

This task focuses ONLY on code-level deprecation comments.

## Edge Cases & Considerations

### 1. Mixed Usage (Constants + String Literals)

**Scenario**: Some code uses constants, some uses string literals

**Behavior**: Both work perfectly. No conflicts.

**Example**:
```go
// Old code using constant - still works
task1 := &models.Task{AgentType: &models.AgentTypeBackend}

// New code using string literal - also works
backend := "backend"
task2 := &models.Task{AgentType: &backend}

// Both stored identically in database as "backend"
```

### 2. IDE/Editor Warnings

**Scenario**: Developer uses deprecated constant

**Expected Behavior**: IDE shows strikethrough or deprecation warning

**Action**: Developer can either:
- Continue using constant (no error, just warning)
- Migrate to string literal to remove warning

### 3. Go Vet / Linters

**Scenario**: Static analysis tools detect deprecated usage

**Expected Behavior**: Tools report deprecation as informational warning (not error)

**Action**: No immediate action required. Warnings inform but don't block.

### 4. Godoc Generation

**Scenario**: Generated documentation shows deprecated items

**Expected Behavior**: Go doc displays "Deprecated:" prefix clearly

**Verification**: Run `go doc internal/models.AgentType` to verify deprecation shows

## Runtime Behavior

**IMPORTANT**: Deprecation comments are documentation-only. They have ZERO impact on runtime behavior.

**Runtime Guarantees**:
- ✅ No performance impact
- ✅ No validation changes
- ✅ No database changes
- ✅ No functional behavior changes
- ✅ Constants work exactly as before

**Deprecation Warnings**:
- ❌ NOT emitted at runtime (Go doesn't support runtime deprecation warnings)
- ✅ ONLY shown in IDEs, linters, and go doc

## Success Criteria

### Immediate Success Indicators

1. **Deprecation comments added**: All 7 items (type + 6 constants) have deprecation comments
2. **Comments follow standard**: Use `Deprecated:` prefix per Go conventions
3. **All tests pass**: Existing test suite passes without modification
4. **No functional changes**: Code behaves identically pre/post deprecation

### Long-Term Success Indicators

1. **New code uses string literals**: Developers naturally use strings instead of constants
2. **No breaking changes reported**: Zero issues from constant deprecation
3. **Clear migration path**: Developers understand how to use new flexible agent types

## Related Tasks

**Prerequisites**:
- None (this task is independent)

**Dependent Tasks**:
- T-E07-F13-001: Update ValidateAgentType function (validation changes)
- T-E07-F13-003: Update template renderer validation (fallback logic)
- T-E07-F13-005: Update documentation (CLAUDE.md, README.md, CLI_REFERENCE.md)

**Task Coordination**:
- This task can be completed independently
- No coordination required with other tasks
- Changes are purely documentation comments

## Notes

### Why Not Emit Runtime Warnings?

**Considered**: Adding runtime deprecation warnings when constants are used

**Rejected Because**:
1. Go doesn't have native runtime deprecation mechanism
2. Would add runtime overhead for no functional benefit
3. IDE warnings are sufficient for developer guidance
4. Constants are harmless to continue using (no security/performance issues)

### Why Keep Constants Indefinitely?

**Benefits of Keeping**:
- Zero migration burden on existing codebases
- Constants are harmless (just string aliases)
- Backward compatibility is valuable
- Removal provides minimal benefit

**Costs of Removing**:
- Breaking change requiring major version bump
- Forces migration across all codebases
- Creates support burden
- Provides no functional improvement

**Decision**: Keep constants indefinitely as deprecated but functional.

### Best Practices for Deprecation

1. **Clear documentation**: Explain why deprecated and what to use instead
2. **Migration path**: Show concrete examples of old vs. new patterns
3. **No forced migration**: Allow time for gradual adoption
4. **Backward compatibility**: Keep deprecated code functional
5. **Context reference**: Link to feature (E07-F13) for full context

---
key: T-E07-F23-004
title: Implement Agent Responsibility Detection
epic: E07
feature: E07-F23
agent: backend
status: todo
priority: 3
depends_on: ["T-E07-F23-001"]
created_at: 2026-01-16T19:55:39Z
---

# Task: Implement Agent Responsibility Detection

**Estimated Effort:** 1.5 hours
**Phase:** 1 - Core Calculations
**Dependencies:** T-E07-F23-001 (Status package types)

---

## Goal

Implement `GetStatusContext()` and `GetActionItems()` functions to detect status context and identify actionable tasks.

---

## Implementation

### Create `internal/status/context.go`

```go
package status

import "github.com/jwwelbor/shark-task-manager/internal/config"

// GetStatusContext returns contextual status suffix for display
// Examples: "active (waiting)", "active (blocked)", "active (development)"
func GetStatusContext(feature interface{}, statusCounts map[string]int, cfg *config.Config) string {
    // Type assert feature to get status
    // If status != "active", return as-is
    
    // Check for waiting (tasks awaiting approval)
    if statusCounts["ready_for_approval"] > 0 || statusCounts["ready_for_code_review"] > 0 {
        return "active (waiting)"
    }

    // Check for blocked
    if statusCounts["blocked"] > 0 {
        return "active (blocked)"
    }

    // Check for development
    if statusCounts["in_development"] > 0 || statusCounts["in_progress"] > 0 {
        return "active (development)"
    }

    return "active"
}
```

### Create `internal/status/action_items.go`

```go
package status

import (
    "time"
    "github.com/jwwelbor/shark-task-manager/internal/config"
)

// GetActionItems categorizes tasks requiring immediate attention
func GetActionItems(tasks []interface{}, cfg *config.Config) *ActionItems {
    items := &ActionItems{
        AwaitingApproval: []*TaskActionItem{},
        Blocked:          []*TaskActionItem{},
        InProgress:       []*TaskActionItem{},
    }

    now := time.Now()

    for _, t := range tasks {
        // Type assert to models.Task
        // Check status metadata
        // Categorize into appropriate list
    }

    return items
}
```

---

## Files to Create

- `internal/status/context.go` - GetStatusContext() implementation
- `internal/status/action_items.go` - GetActionItems() implementation
- `internal/status/context_test.go` - Unit tests
- `internal/status/action_items_test.go` - Unit tests

---

## Acceptance Criteria

- [ ] GetStatusContext() implemented and tested
- [ ] GetActionItems() implemented and tested
- [ ] Detects waiting, blocked, and development states
- [ ] Calculates age in days for waiting tasks
- [ ] Extracts blocked reasons
- [ ] All tests pass with >85% coverage

---

## Related Documentation

- Architecture: `architecture.md` (Sections 4.2.3 and 4.2.4)
- Implementation Plan: `implementation-plan.md` (Task E07-F23-004)

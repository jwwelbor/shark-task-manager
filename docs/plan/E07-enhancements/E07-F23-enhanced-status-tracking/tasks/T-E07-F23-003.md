---
key: T-E07-F23-003
title: Implement Work Breakdown Calculation
epic: E07
feature: E07-F23
agent: backend
status: todo
priority: 3
depends_on: ["T-E07-F23-001"]
created_at: 2026-01-16T19:55:33Z
---

# Task: Implement Work Breakdown Calculation

**Estimated Effort:** 2 hours
**Phase:** 1 - Core Calculations
**Dependencies:** T-E07-F23-001 (Status package types)

---

## Goal

Implement `CalculateWorkRemaining()` using `responsibility` and `blocks_feature` from config. Categorize work by responsibility: agent, human, qa_team, none. Show who's responsible for remaining work.

---

## Implementation

### Create `internal/status/work_breakdown.go`

```go
package status

import "github.com/jwwelbor/shark-task-manager/internal/config"

// CalculateWorkRemaining breaks down work by responsibility
// Uses responsibility and blocks_feature from config
func CalculateWorkRemaining(statusCounts map[string]int, cfg *config.Config) *WorkSummary {
    summary := &WorkSummary{}

    for status, count := range statusCounts {
        meta := cfg.GetStatusMetadata(status)
        if meta == nil {
            continue
        }

        summary.TotalTasks += count

        switch meta.Responsibility {
        case "agent":
            summary.AgentWork += count
        case "human", "qa_team":
            summary.HumanWork += count
        case "none":
            if meta.BlocksFeature {
                summary.BlockedWork += count
            } else if meta.ProgressWeight == 0.0 {
                summary.NotStarted += count
            } else if meta.ProgressWeight >= 1.0 {
                summary.CompletedTasks += count
            }
        }

        if meta.ProgressWeight >= 1.0 {
            summary.CompletedTasks += count
        }
    }

    return summary
}
```

### Create `internal/status/work_breakdown_test.go`

Test cases:
1. All agent work → AgentWork count correct
2. All human work → HumanWork count correct
3. Blocked tasks → BlockedWork count correct
4. Mixed responsibilities → all counts correct
5. Missing metadata → graceful handling

---

## Files to Create

- `internal/status/work_breakdown.go` - CalculateWorkRemaining() implementation
- `internal/status/work_breakdown_test.go` - Comprehensive unit tests (>90% coverage)

---

## Acceptance Criteria

- [ ] CalculateWorkRemaining() function implemented
- [ ] Uses `cfg.GetStatusMetadata(status).Responsibility`
- [ ] Uses `cfg.GetStatusMetadata(status).BlocksFeature`
- [ ] Categorizes by responsibility: agent, human, qa_team, none
- [ ] Calculates not started (progress_weight=0.0)
- [ ] Calculates completed (progress_weight>=1.0)
- [ ] All test cases pass: `go test ./internal/status -v`
- [ ] Coverage >90%: `go test ./internal/status -cover`

---

## Testing Commands

```bash
# Run tests
go test ./internal/status -v -run TestCalculateWorkRemaining

# Check coverage
go test ./internal/status -coverprofile=coverage.out
go tool cover -func=coverage.out | grep work_breakdown.go
```

---

## Related Documentation

- Architecture: `architecture.md` (Section 4.2.2 - CalculateWorkRemaining)
- Implementation Plan: `implementation-plan.md` (Task E07-F23-003)

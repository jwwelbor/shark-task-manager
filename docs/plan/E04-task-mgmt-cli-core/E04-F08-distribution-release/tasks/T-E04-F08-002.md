---
task_key: T-E04-F08-002
status: created
feature: /docs/plan/E04-task-mgmt-cli-core/E04-F08-distribution-release
created: 2025-12-17
assigned_agent: devops-engineer
dependencies: [T-E04-F08-001.md]
estimated_time: 6 hours
---

# Task: GitHub Actions CI/CD Workflow

## Goal

Create and validate GitHub Actions workflow that automates the complete release process, triggering on Git tag pushes and producing draft releases with all platform binaries.

## Success Criteria

- [ ] `.github/workflows/release.yml` created with complete automation
- [ ] Workflow triggers on `v*` tag patterns only
- [ ] Tests execute before build (release gate)
- [ ] GoReleaser runs successfully in CI environment
- [ ] Draft GitHub release created with all 6 assets (5 binaries + checksums)
- [ ] Workflow completes in <10 minutes
- [ ] Test tag successfully triggers and completes workflow
- [ ] Repository settings configured correctly

## Implementation Guidance

### Overview

Implement automated CI/CD pipeline using GitHub Actions that executes tests, builds multi-platform binaries with GoReleaser, and creates draft GitHub releases. The workflow must enforce quality gates (tests must pass) before building releases.

### Key Requirements

- **Trigger Configuration**: Workflow triggers only on tags matching `v*` pattern (e.g., `v1.0.0`, `v0.1.0-beta`) - See [Architecture - CI/CD Pipeline](../02-architecture.md#cicd-pipeline)
- **Quality Gates**: Execute full test suite before allowing build to proceed - See [Security - Release Gates](../06-security-design.md#release-gates)
- **GoReleaser Integration**: Use official GoReleaser Action with automatic GitHub token - See [Architecture - GitHub Actions Workflow](../02-architecture.md#github-actions-workflow)
- **Draft Releases**: Create releases as drafts initially for manual review before publication - See [Architecture - Release Creation](../02-architecture.md#release-creation)
- **Performance**: Workflow must complete within 10-minute target - See [Performance - Workflow Optimization](../07-performance-design.md#workflow-optimization)

### Files to Create/Modify

**CI/CD Configuration**:
- `.github/workflows/release.yml` - Complete release automation workflow

**Repository Settings** (manual via GitHub UI):
- Enable GitHub Actions (if not already enabled)
- Configure branch protection for `main` branch
- Set up required status checks

### Integration Points

- **GoReleaser Config**: Uses `.goreleaser.yml` from Task 001
- **Test Suite**: Executes existing `go test ./...` command
- **GitHub Token**: Uses automatic `GITHUB_TOKEN` (no manual secrets needed yet)
- **Future Package Managers**: Workflow will be extended in Task 003 for Homebrew/Scoop

Reference: [Architecture - Workflow Integration](../02-architecture.md#workflow-integration)

## Validation Gates

**Workflow Structure Validation**:
- Workflow YAML syntax is valid (check with `yamllint`)
- Step names are clear and descriptive
- Error handling configured for critical steps
- Timeout configured (10-minute max)

**Trigger Validation**:
- Create test tag: `git tag v0.0.1-test && git push origin v0.0.1-test`
- Verify workflow triggers automatically
- Confirm workflow doesn't trigger on non-tag pushes
- Confirm workflow doesn't trigger on non-matching tags (e.g., `release-1.0`)

**Test Gate Validation**:
- Introduce deliberate test failure
- Verify workflow fails before build step
- Confirm no artifacts created when tests fail
- Fix test and verify workflow proceeds

**Build Validation**:
- Monitor workflow execution in GitHub Actions UI
- Verify all 5 platforms build successfully
- Confirm draft release created with 6 assets
- Verify release notes auto-generated from commits

**Performance Validation**:
- Measure total workflow duration (target: <10 min)
- Identify any bottlenecks or slow steps
- Compare against performance targets

Reference: [Test Criteria - Phase 2 Tests](../09-test-criteria.md#phase-2-github-actions-workflow--cicd-setup)

## Context & Resources

- **Architecture**: [CI/CD Pipeline Architecture](../02-architecture.md#cicd-pipeline)
- **Architecture**: [GitHub Actions Configuration](../02-architecture.md#github-actions-workflow)
- **Architecture**: [Release Creation Process](../02-architecture.md#release-creation)
- **Security**: [CI/CD Security Controls](../06-security-design.md#cicd-security)
- **Security**: [Token Management](../06-security-design.md#token-management)
- **Performance**: [Workflow Performance Targets](../07-performance-design.md#workflow-optimization)
- **Implementation**: [Phase 2 Tasks](../08-implementation-phases.md#phase-2-github-actions-workflow--cicd-setup)
- **Testing**: [Workflow Tests](../09-test-criteria.md#cicd-integration)

## Notes for Agent

- **GoReleaser Action**: Use `goreleaser/goreleaser-action@v6` (check for latest version)
- **Token Usage**: GitHub automatically provides `GITHUB_TOKEN` with necessary permissions
- **Draft Releases**: Use `draft: true` in GoReleaser config (allows manual review before publication)
- **Test Tag Cleanup**: Delete test tags after validation: `git tag -d v0.0.1-test && git push origin :refs/tags/v0.0.1-test`
- **Branch Protection**: Don't block tags with branch protection (only protect branches)
- **Workflow Comments**: Add comments explaining non-obvious configurations
- **Caching**: Consider Go module caching to speed up builds (may add in optimization phase)
- **Release Notes**: GoReleaser auto-generates from commits; can customize later if needed

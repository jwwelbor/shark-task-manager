
---
key: T-E07-F01-004
title: Implement epic creator function with custom filename support
epic: E07
feature: E07-F01
agent: backend
status: todo
priority: 4
created_at: 2025-12-18T04:54:03Z
---

# Task: Epic Creation with Custom Filenames

## Goal

Create or update epic creation logic to accept custom filenames, implement collision detection, file association, and force reassignment.

**Reference**: See dev-artifacts/2025-12-18-custom-filename-feature/PROGRESS.md Phase 3 and internal/taskcreation/creator.go:65-198 for task implementation pattern.

## Requirements

### Functional Requirements

- [ ] Create CreateEpicInput struct with Title, Filename, Force fields
- [ ] Create CreateEpic(ctx, input) function in creator or separate package
- [ ] Accept custom filename paths with validation
- [ ] Detect file collisions with other epics
- [ ] Support force reassignment (clear file_path from other epic)
- [ ] Associate existing files without modification
- [ ] Create new files if they don't exist
- [ ] Use atomic transactions for multi-step operations
- [ ] Return created epic with key and file_path

### Non-Functional Requirements

- [ ] Transaction handling ensures atomicity
- [ ] Error messages match task creator format
- [ ] File operations match task creator behavior

## Implementation Plan

### Files to Modify

1. **internal/taskcreation/creator.go** or new **internal/taskcreation/epic_creator.go**
   - Add CreateEpicInput struct
   - Add CreateEpic function
   - Implement custom filename handling
   - Implement collision detection
   - Implement force reassignment logic

2. **internal/cli/commands/epic.go**
   - Update runEpicCreate to parse new flags (next task)

### Steps

1. [ ] Review CreateTaskInput struct and CreateTask method in creator.go
2. [ ] Create CreateEpicInput struct with Title, Filename, Force fields
3. [ ] Create CreateEpic function following task creator pattern
4. [ ] Implement file path validation using ValidateCustomFilename
5. [ ] Implement collision detection using EpicRepository.GetByFilePath
6. [ ] Implement force reassignment using EpicRepository.UpdateFilePath
7. [ ] Implement file handling (check existence, create if needed)
8. [ ] Wrap in transaction for atomicity
9. [ ] Test with manual CLI invocation

## Deliverables

- [ ] CreateEpic function implemented
- [ ] Custom filename handling complete
- [ ] Collision detection and force reassignment working
- [ ] File association working
- [ ] Error handling with clear messages
- [ ] Tests passing

## Acceptance Criteria

- [ ] Function follows task creator patterns exactly
- [ ] All validation rules applied
- [ ] Collision detection prevents overwrites
- [ ] Force reassignment updates both epics atomically
- [ ] Existing files associated without modification
- [ ] New files created with appropriate headers
- [ ] All edge cases handled

## Testing Strategy

- [ ] Unit tests for CreateEpic function
- [ ] Test valid filenames and collision detection
- [ ] Test force reassignment behavior
- [ ] Test file creation and association
- [ ] Integration tests with database

## Dependencies

Depends on: T-E07-F01-001, T-E07-F01-002, T-E07-F01-003



---
key: T-E07-F01-008
title: Add file_path columns and indexes to epics and features tables
epic: E07
feature: E07-F01
agent: backend
status: todo
priority: 8
created_at: 2025-12-18T04:54:03Z
---

# Task: Database Schema Migration

## Goal

Add `file_path` columns and UNIQUE indexes to both epics and features tables in the database schema.

## Requirements

### Functional Requirements

- [ ] Add file_path TEXT column to epics table
- [ ] Add file_path TEXT column to features table
- [ ] Columns are nullable (can be NULL)
- [ ] Add UNIQUE constraint on file_path columns
- [ ] Add performance indexes: idx_epics_file_path, idx_features_file_path

### Non-Functional Requirements

- [ ] Schema changes in internal/db/db.go
- [ ] Follows existing schema patterns
- [ ] Indexes created for query performance

## Implementation Plan

### Files to Modify

1. **internal/db/db.go**
   - Add ALTER TABLE epics ADD COLUMN file_path TEXT UNIQUE;
   - Add ALTER TABLE features ADD COLUMN file_path TEXT UNIQUE;
   - Add CREATE INDEX idx_epics_file_path ON epics(file_path);
   - Add CREATE INDEX idx_features_file_path ON features(file_path);

### Steps

1. [ ] Review task table schema changes in internal/db/db.go (line 159)
2. [ ] Add column definitions for epics and features tables
3. [ ] Add index creation statements
4. [ ] Test with: `make clean && make build`
5. [ ] Verify schema with fresh database initialization

## Deliverables

- [ ] file_path column added to epics table
- [ ] file_path column added to features table
- [ ] UNIQUE constraints applied
- [ ] Indexes created
- [ ] Code compiles and database initializes correctly

## Acceptance Criteria

- [ ] Columns exist in schema
- [ ] NULL values allowed
- [ ] UNIQUE constraints prevent duplicates
- [ ] Indexes created for performance
- [ ] Fresh database initialization works

## Dependencies

Depends on: T-E07-F01-003 (models must be updated first)

